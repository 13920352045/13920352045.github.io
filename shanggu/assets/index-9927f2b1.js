import{g as j,t as z,n as K,m as O,d as q,r as L,h as G,i as ue,j as re,k as f,l as J,p as S,q as ve,s as fe,v as de,x as U,y as he,z as ge,A as me,B as we,C as ye,a as C,D as V,E as F,G as I,H as pe,I as _,J as Q,K as be}from"./index-a87c8d91.js";const[Z,k]=j("swipe"),xe={loop:z,width:K,height:K,vertical:Boolean,autoplay:O(0),duration:O(500),touchable:z,lazyRender:Boolean,initialSwipe:O(0),indicatorColor:String,showIndicators:z,stopPropagation:z},ee=Symbol(Z);var Te=q({name:Z,props:xe,emits:["change"],setup(i,{emit:P,slots:h}){const u=L(),d=L(),e=G({rect:null,width:0,height:0,offset:0,active:0,swiping:!1}),r=ue(),{children:g,linkChildren:E}=re(ee),a=f(()=>g.length),l=f(()=>e[i.vertical?"height":"width"]),s=f(()=>i.vertical?r.deltaY.value:r.deltaX.value),m=f(()=>e.rect?(i.vertical?e.rect.height:e.rect.width)-l.value*a.value:0),M=f(()=>l.value?Math.ceil(Math.abs(m.value)/l.value):a.value),p=f(()=>a.value*l.value),$=f(()=>(e.active+a.value)%a.value),B=f(()=>{const t=i.vertical?"vertical":"horizontal";return r.direction.value===t}),te=f(()=>{const t={transitionDuration:`${e.swiping?0:i.duration}ms`,transform:`translate${i.vertical?"Y":"X"}(${e.offset}px)`};if(l.value){const o=i.vertical?"height":"width",n=i.vertical?"width":"height";t[o]=`${p.value}px`,t[n]=i[n]?`${i[n]}px`:""}return t}),ae=t=>{const{active:o}=e;return t?i.loop?_(o+t,-1,a.value):_(o+t,0,M.value):o},R=(t,o=0)=>{let n=t*l.value;i.loop||(n=Math.min(n,-m.value));let v=o-n;return i.loop||(v=_(v,m.value,0)),v},w=({pace:t=0,offset:o=0,emitChange:n})=>{if(a.value<=1)return;const{active:v}=e,c=ae(t),T=R(c,o);if(i.loop){if(g[0]&&T!==m.value){const D=T<m.value;g[0].setOffset(D?p.value:0)}if(g[a.value-1]&&T!==0){const D=T>0;g[a.value-1].setOffset(D?-p.value:0)}}e.active=c,e.offset=T,n&&c!==v&&P("change",$.value)},A=()=>{e.swiping=!0,e.active<=-1?w({pace:a.value}):e.active>=a.value&&w({pace:-a.value})},ie=()=>{A(),r.reset(),I(()=>{e.swiping=!1,w({pace:-1,emitChange:!0})})},Y=()=>{A(),r.reset(),I(()=>{e.swiping=!1,w({pace:1,emitChange:!0})})};let H;const b=()=>clearTimeout(H),x=()=>{b(),i.autoplay>0&&a.value>1&&(H=setTimeout(()=>{Y(),x()},+i.autoplay))},y=(t=+i.initialSwipe)=>{if(!u.value)return;const o=()=>{var n,v;if(!V(u)){const c={width:u.value.offsetWidth,height:u.value.offsetHeight};e.rect=c,e.width=+((n=i.width)!=null?n:c.width),e.height=+((v=i.height)!=null?v:c.height)}a.value&&(t=Math.min(a.value-1,t),t===-1&&(t=a.value-1)),e.active=t,e.swiping=!0,e.offset=R(t),g.forEach(c=>{c.setOffset(0)}),x()};V(u)?F().then(o):o()},X=()=>y(e.active);let N;const ne=t=>{i.touchable&&(r.start(t),N=Date.now(),b(),A())},oe=t=>{i.touchable&&e.swiping&&(r.move(t),B.value&&(!i.loop&&(e.active===0&&s.value>0||e.active===a.value-1&&s.value<0)||(pe(t,i.stopPropagation),w({offset:s.value}))))},W=()=>{if(!i.touchable||!e.swiping)return;const t=Date.now()-N,o=s.value/t;if((Math.abs(o)>.25||Math.abs(s.value)>l.value/2)&&B.value){const v=i.vertical?r.offsetY.value:r.offsetX.value;let c=0;i.loop?c=v>0?s.value>0?-1:1:0:c=-Math[s.value>0?"ceil":"floor"](s.value/l.value),w({pace:c,emitChange:!0})}else s.value&&w({pace:0});e.swiping=!1,x()},se=(t,o={})=>{A(),r.reset(),I(()=>{let n;i.loop&&t===a.value?n=e.active===0?0:t:n=t%a.value,o.immediate?I(()=>{e.swiping=!1}):e.swiping=!1,w({pace:n-e.active,emitChange:!0})})},le=(t,o)=>{const n=o===$.value,v=n?{backgroundColor:i.indicatorColor}:void 0;return C("i",{style:v,class:k("indicator",{active:n})},null)},ce=()=>{if(h.indicator)return h.indicator({active:$.value,total:a.value});if(i.showIndicators&&a.value>1)return C("div",{class:k("indicators",{vertical:i.vertical})},[Array(a.value).fill("").map(le)])};return J({prev:ie,next:Y,state:e,resize:X,swipeTo:se}),E({size:l,props:i,count:a,activeIndicator:$}),S(()=>i.initialSwipe,t=>y(+t)),S(a,()=>y(e.active)),S(()=>i.autoplay,x),S([ve,fe],X),S(de(),t=>{t==="visible"?x():b()}),U(y),he(()=>y(e.active)),ge(()=>y(e.active)),me(b),we(b),ye("touchmove",oe,{target:d}),()=>{var t;return C("div",{ref:u,class:k()},[C("div",{ref:d,style:te.value,class:k("track",{vertical:i.vertical}),onTouchstartPassive:ne,onTouchend:W,onTouchcancel:W},[(t=h.default)==null?void 0:t.call(h)]),ce()])}}});const Ae=Q(Te),[Se,Ce]=j("swipe-item");var Pe=q({name:Se,setup(i,{slots:P}){let h;const u=G({offset:0,inited:!1,mounted:!1}),{parent:d,index:e}=be(ee);if(!d)return;const r=f(()=>{const a={},{vertical:l}=d.props;return d.size.value&&(a[l?"height":"width"]=`${d.size.value}px`),u.offset&&(a.transform=`translate${l?"Y":"X"}(${u.offset}px)`),a}),g=f(()=>{const{loop:a,lazyRender:l}=d.props;if(!l||h)return!0;if(!u.mounted)return!1;const s=d.activeIndicator.value,m=d.count.value-1,M=s===0&&a?m:s-1,p=s===m&&a?0:s+1;return h=e.value===s||e.value===M||e.value===p,h}),E=a=>{u.offset=a};return U(()=>{F(()=>{u.mounted=!0})}),J({setOffset:E}),()=>{var a;return C("div",{class:Ce(),style:r.value},[g.value?(a=P.default)==null?void 0:a.call(P):null])}}});const ze=Q(Pe);export{ze as S,Ae as a};
